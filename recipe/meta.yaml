{% set version = "0.6.9" %}
{% set build_number = "1" %}

package:
  name: dagster
  version: {{ version }}

source:
  - folder: dagit
    url: "https://pypi.io/packages/source/d/dagit/dagit-{{ version }}.tar.gz"
    sha256: 80b797cc65d10dec1931d5b726e38a826823c5fcb36f1c06e0d3dcf581fca2ac

  - folder: dagster
    url: "https://pypi.io/packages/source/d/dagster/dagster-{{ version }}.tar.gz"
    sha256: e9a683eae89a6a2898b68ea8a3fde2cf30a5192c391b2cf8dab8a08f10ee28d3

  - folder: dagster-bash
    url: "https://pypi.io/packages/source/d/dagster-bash/dagster-bash-{{ version }}.tar.gz"
    sha256: 8b1d280d7093b2745e92a8a280bb7558d4b6c30f9712bfee3821aaa52407534c

  - folder: dagster-cron
    url: "https://pypi.io/packages/source/d/dagster-cron/dagster-cron-{{ version }}.tar.gz"
    sha256: d6ca15a17597f5ffc0ecf3b50165391972d4eacd6e7a7fc62cb8fca8f08fe155

  - folder: dagster-dask
    url: "https://pypi.io/packages/source/d/dagster-dask/dagster-dask-{{ version }}.tar.gz"
    sha256: 76c05e3ce984fc12b90ca155d1b32cbf7d1360cfde299031348fc9252f0c0a9a

  - folder: dagster-datadog
    url: "https://pypi.io/packages/source/d/dagster-datadog/dagster-datadog-{{ version }}.tar.gz"
    sha256: 99906b28227f0c6009c482bb8d4e275d771e543c6d48138a944d940a988ed304

  - folder: dagster-dbt
    url: "https://pypi.io/packages/source/d/dagster-dbt/dagster-dbt-{{ version }}.tar.gz"
    sha256: c80b06b46d96d6f32b816d013812bb42469e672f9ea57dfef426055f7c0649ab

  - folder: dagster-gcp
    url: "https://pypi.io/packages/source/d/dagster-gcp/dagster-gcp-{{ version }}.tar.gz"
    sha256: f7c309f0dd71e3a51ec7ad09d853bb15a85e940986066687cdc0784714bdd03b

  - folder: dagster-ge
    url: "https://pypi.io/packages/source/d/dagster-ge/dagster-ge-{{ version }}.tar.gz"
    sha256: 5ddae6ab8185e61899203837c3cb80c224fafb4a87ff4a1d9d7d18e69c2d934d

  - folder: dagster-github
    url: "https://pypi.io/packages/source/d/dagster-github/dagster-github-{{ version }}.tar.gz"
    sha256: 50edfc0b9dfeca90a4eb451b274fc721fb5a56b4d3882da49f93c24ea96c4af8

  - folder: dagster-graphql
    url: "https://pypi.io/packages/source/d/dagster-graphql/dagster-graphql-{{ version }}.tar.gz"
    sha256: 3dd6a8757f5994acf0d79bf0660d63c9ea04f1b63947a71a7eadd98b10008985

  - folder: dagster-pagerduty
    url: "https://pypi.io/packages/source/d/dagster-pagerduty/dagster-pagerduty-{{ version }}.tar.gz"
    sha256: 164aefdb477c49fdce0fbad2b47c79854f29de8667f5fa89fd17d839a205167d

  - folder: dagster-pandas
    url: "https://pypi.io/packages/source/d/dagster-pandas/dagster-pandas-{{ version }}.tar.gz"
    sha256: 9aa1f75f71140e1b2a957de708fe0da754b7862a8fbf0588f804f2602b744610

  - folder: dagster-papertrail
    url: "https://pypi.io/packages/source/d/dagster-papertrail/dagster-papertrail-{{ version }}.tar.gz"
    sha256: a9454b32be7f29b3108d996ad440b06751a9e88690f5f90db292f1ebcfc36fdc

  - folder: dagster-postgres
    url: "https://pypi.io/packages/source/d/dagster-postgres/dagster-postgres-{{ version }}.tar.gz"
    sha256: ebfc9ec2a6e342ad3a19e9e633b5039d0356c54abe667ebf34d1853eea2fd493

  - folder: dagster-prometheus
    url: "https://pypi.io/packages/source/d/dagster-prometheus/dagster-prometheus-{{ version }}.tar.gz"
    sha256: 5bdf9a500abe8e8fa0c7cb9043101b17edadd388c8ae4834c07de82a169893e1

  - folder: dagster-slack
    url: "https://pypi.io/packages/source/d/dagster-slack/dagster-slack-{{ version }}.tar.gz"
    sha256: 7caa42e161713af5aff4e066c1a965127d9cdd488f2488284daa8778f9b06892

  - folder: dagster-snowflake
    url: "https://pypi.io/packages/source/d/dagster-snowflake/dagster-snowflake-{{ version }}.tar.gz"
    sha256: 114a82cb57efe30f1e6005ed3ccf66881626caf19b3ed0af8f83d9ff2ac6e783

  - folder: dagster-spark
    url: "https://pypi.io/packages/source/d/dagster-spark/dagster-spark-{{ version }}.tar.gz"
    sha256: 22fa61e33dd8fd3373ce214ebde91b738f1b970f0161f8879cebbc3048832ff2

  - folder: dagster-ssh
    url: "https://pypi.io/packages/source/d/dagster-ssh/dagster-ssh-{{ version }}.tar.gz"
    sha256: cffcd353718b8eee2502a7f436da8d3b1dc8b2ae89363451dd57cd2f8ff14982

  - folder: dagster-twilio
    url: "https://pypi.io/packages/source/d/dagster-twilio/dagster-twilio-{{ version }}.tar.gz"
    sha256: 33ce7363d1e00517bc6bfa06e6e05ba476a17e36a68a9b376b6409f41a814286


build:
  number: {{ build_number }}


requirements:
  host:
    - python
  run:
    - python


test:
  commands:
    - echo "TODO"


outputs:
  - name: dagit
    build:
      number: {{ build_number }}
      noarch: python
      entry_points:
        - dagit-cli = dagit.cli:main
        - dagit = dagit.dagit:main
      script: cd dagit && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - click >=7.0
        - dagster {{ version }}.*
        - dagster-graphql {{ version }}.*
        - enum-compat >=0.0.1
        - flask >=0.12.4
        - flask-cors >=3.0.6
        - flask-graphql >=2.0.0
        - flask-sockets >=0.2.1
        - future
        - gevent
        - gevent-websocket >=0.10.1
        - graphql-core >=2.1,<3
        - graphql-ws >=0.3.0
        - nbconvert >=5.4.0
        - python
        - pyyaml
        - watchdog >=0.8.3

    test:
      requires:
        - pip
      imports:
        - dagit
        - dagit.schema
        - dagit.templates
      commands:
        - python -m pip check
        - dagit-cli --help
        - dagit --help

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/dagit"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagit/LICENSE
      summary: "Dagster UI"

  - name: dagster
    build:
      number: {{ build_number }}
      entry_points:
        - dagster = dagster.cli:main
      script: cd dagster && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - alembic
        - backports.tempfile  # [py2k]
        - click >=5.0
        - coloredlogs >=6.1
        - contextlib2 >=0.5.4
        - enum-compat >=0.0.1
        - funcsigs
        - functools32  # [py2k]
        - future
        - gevent
        - pathlib2 >=2.3.4  # [py2k]
        - psutil >=1.0  # [win]
        - pyrsistent >=0.14.8
        - python
        - python-graphviz >=0.8.4
        - pywin32 !=226  # [win]
        - pyyaml >=3.10,<5
        - rx 1.6.1.*
        - six
        - sqlalchemy >=1.0
        - toposort >=1.0
        - typing  # [py2k]
        - watchdog >=0.8.3

    test:
      requires:
        - pip
      imports:
        - dagster
        - dagster.check
        - dagster.cli
        - dagster.core
        - dagster.core.definitions
        - dagster.core.engine
        - dagster.core.events
        - dagster.core.execution
        - dagster.core.execution.context
        - dagster.core.execution.plan
        - dagster.core.instance
        - dagster.core.scheduler
        - dagster.core.selector
        - dagster.core.serdes
        - dagster.core.storage
        - dagster.core.system_config
        - dagster.core.types
        - dagster.core.types.evaluator
        - dagster.loggers
        - dagster.seven
        - dagster.utils
      commands:
        - dagster --help
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster/LICENSE
      summary: "Dagster is an opinionated programming model for data pipelines."

  - name: dagster-bash
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-bash && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_bash
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-bash"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-bash/LICENSE
      summary: "Package for Dagster bash solids."

  - name: dagster-cron
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-cron && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - python
        - python-crontab >=2.3.8

    test:
      requires:
        - pip
      imports:
        - dagster_cron
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-cron"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-cron/LICENSE
      summary: "A Dagster integration for cron"

  - name: dagster-dask
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-dask && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python >=3
      run:
        - bokeh
        - dagster {{ version}}.*
        - dagster-graphql {{ version }}.*
        - dask >=1.2.2
        - distributed >=1.28.1
        - python >=3

    test:
      requires:
        - pip
      imports:
        - dagster_dask
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-dask"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-dask/LICENSE
      summary: "Package for using Dask as Dagster's execution engine."

  - name: dagster-datadog
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-datadog && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python

      run:
        - dagster {{ version }}.*
        - datadog
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_datadog
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-datadog"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-datadog/LICENSE
      summary: "Package for datadog Dagster framework components."

  - name: dagster-dbt
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-dbt && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python

      run:
        - dagster {{ version }}.*
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_dbt
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-dbt"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-dbt/LICENSE
      summary: "Package for Dagster dbt integration."

  - name: dagster-gcp
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-gcp && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster
        - dagster-pandas
        - google-api-python-client
        - google-cloud-bigquery >=1.19
        - google-cloud-storage
        - google-resumable-media
        - oauth2client
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_gcp
        - dagster_gcp.bigquery
        - dagster_gcp.dataproc
        - dagster_gcp.gcs
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-gcp"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-gcp/LICENSE
      summary: "Package for GCP-specific Dagster framework solid and resource components."

  - name: dagster-ge
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-ge && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - great-expectations <=0.7.6
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_ge
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-ge"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-ge/LICENSE
      summary: "Great Expectations plugin for Dagster"

  - name: dagster-github
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-github && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - cryptography >=1.4
        - dagster {{ version }}.*
        - pyjwt
        - requests

    test:
      requires:
        - pip
      imports:
        - dagster_github
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-github"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-github/LICENSE
      summary: "Github plugin for Dagster"

  - name: dagster-graphql
    build:
      number: {{ build_number }}
      noarch: python
      entry_points:
        - dagster-graphql = dagster_graphql.cli:main
      script: cd dagster-graphql && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - gevent
        - gevent-websocket >=0.10.1
        - graphene >=2.1.3
        - python
        - requests

    test:
      requires:
        - pip
      imports:
        - dagster_graphql
        - dagster_graphql.client
        - dagster_graphql.schema
      commands:
        - dagster-graphql --help
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/dagster-graphql"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-graphql/LICENSE
      summary: "The GraphQL frontend to python dagster."

  - name: dagster-pagerduty
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-pagerduty && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - pypd 1.1.*
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_pagerduty
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-pagerduty"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-pagerduty/LICENSE
      summary: "Package for pagerduty Dagster framework components."

  - name: dagster-pandas
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-pandas && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - matplotlib-base
        - pandas
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_pandas
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-pandas/LICENSE
      summary: "Utilities and examples for working with pandas and dagster, an opinionated framework for expressing data pipelines"

  - name: dagster-papertrail
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-papertrail && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_papertrail
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-papertrail"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-papertrail/LICENSE
      summary: "Package for papertrail Dagster framework components."

  - name: dagster-postgres
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-postgres && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - psycopg2
        - python

    test:
      # this cannot be `pip check`ed because of the psycopg2[-binary] fiasco
      imports:
        - dagster_postgres

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-postgres"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-postgres/LICENSE
      summary: "A Dagster integration for postgres"

  - name: dagster-prometheus
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-prometheus && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - prometheus_client
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_prometheus
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-prometheus"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-prometheus/LICENSE
      summary: "A Dagster integration for prometheus"

  - name: dagster-slack
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-slack && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - python
        - slackclient <2
        - websocket-client <0.55.0,>=0.35
        - ssl_match_hostname

    test:
      requires:
        - pip
      imports:
        - dagster_slack
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-slack"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-slack/LICENSE
      summary: "A Slack client resource for posting to Slack"

  - name: dagster-snowflake
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-snowflake && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - azure-storage-blob <12
        - dagster {{ version }}.*
        - python
        - snowflake-connector-python >=2.1.0

    test:
      requires:
        - pip
      imports:
        - dagster_snowflake
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-snowflake"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-snowflake/LICENSE
      summary: "Package for Snowflake Dagster framework components."

  - name: dagster-spark
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-spark && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - python

    test:
      requires:
        - pip
      imports:
        - dagster_spark
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-spark"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-spark/LICENSE
      summary: "Package for Spark Dagster framework components."

  - name: dagster-ssh
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-ssh && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - paramiko
        - python
        - sshtunnel

    test:
      requires:
        - pip
      imports:
        - dagster_ssh
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-ssh"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-ssh/LICENSE
      summary: "Package for ssh Dagster framework components."

  - name: dagster-twilio
    build:
      number: {{ build_number }}
      noarch: python
      script: cd dagster-twilio && {{ PYTHON }} -m pip install . -vv --no-deps

    requirements:
      host:
        - pip
        - python
      run:
        - dagster {{ version }}.*
        - python
        - twilio

    test:
      requires:
        - pip
      imports:
        - dagster_twilio
      commands:
        - python -m pip check

    about:
      home: "https://github.com/dagster-io/dagster/tree/master/python_modules/libraries/dagster-twilio"
      license: Apache-2.0
      license_family: APACHE
      license_file: dagster-twilio/LICENSE
      summary: "A Dagster integration for twilio"

about:
  home: https://github.com/dagster-io
  summary: 'A Python library for building data applications: ETL, ML, Data Pipelines, and more.'
  license: Apache-2.0
  license_family: APACHE
  license_file: dagster/LICENSE
  doc_url: https://dagster.readthedocs.io
  description: >-
    Dagster is a system for building modern data applications. Combining an
    elegant programming model and beautiful tools, Dagster allows infrastructure
    engineers, data engineers, and data scientists to seamlessly collaborate to
    process and produce the trusted, reliable data needed in today's world.

extra:
  recipe-maintainers:
    - xhochy
    - bollwyvl
    - mgasner
